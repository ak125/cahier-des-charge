#!/bin/bash

# Hook pre-commit pour v√©rifier TypeScript et ESLint
echo "üîç V√©rification du code avant commit..."

# Stocker les fichiers TypeScript modifi√©s
FILES=$(git diff --cached --name-only --diff-filter=ACMRTUXB | grep "\.tsx\?$")

if [ -n "$FILES" ]; then
  echo "‚åõ V√©rification des types TypeScript sur les fichiers modifi√©s..."
  npx tsc --noEmit 
  if [ $? -ne 0 ]; then
    echo "‚ùå Erreur: La v√©rification des types TypeScript a √©chou√©. Commit annul√©."
    exit 1
  fi
  
  echo "‚åõ V√©rification des r√®gles ESLint sur les fichiers modifi√©s..."
  npx eslint $FILES
  if [ $? -ne 0 ]; then
    echo "‚ùå Erreur: La validation ESLint a √©chou√©. Commit annul√©."
    exit 1
  fi
fi

echo "‚úÖ Validation r√©ussie"
exit 0
