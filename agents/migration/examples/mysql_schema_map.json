{
  "version": "1.0.0",
  "generatedAt": "2025-04-12T14:15:00Z",
  "databaseInfo": {
    "name": "ecommerce_db",
    "engine": "MySQL",
    "version": "8.0.28",
    "charset": "utf8mb4",
    "collation": "utf8mb4_unicode_ci"
  },
  "tables": [
    {
      "name": "users",
      "comments": "Table principale stockant les informations des utilisateurs",
      "columns": [
        {
          "name": "id",
          "type": "BIGINT(20) UNSIGNED",
          "nullable": false,
          "defaultValue": null,
          "autoIncrement": true,
          "comment": "Identifiant unique de l'utilisateur"
        },
        {
          "name": "email",
          "type": "VARCHAR(255)",
          "nullable": false,
          "defaultValue": null,
          "comment": "Adresse email unique de l'utilisateur, utilisée pour l'authentification"
        },
        {
          "name": "password",
          "type": "VARCHAR(255)",
          "nullable": false,
          "defaultValue": null,
          "comment": "Mot de passe hashé de l'utilisateur"
        },
        {
          "name": "status",
          "type": "ENUM('ACTIVE', 'INACTIVE', 'SUSPENDED', 'DELETED')",
          "nullable": false,
          "defaultValue": "'ACTIVE'",
          "comment": "Statut actuel du compte utilisateur"
        },
        {
          "name": "is_admin",
          "type": "TINYINT(1)",
          "nullable": false,
          "defaultValue": "0",
          "comment": "Indique si l'utilisateur a des privilèges d'administrateur"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "defaultValue": "CURRENT_TIMESTAMP",
          "comment": "Date de création du compte"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": true,
          "defaultValue": null,
          "onUpdate": "CURRENT_TIMESTAMP",
          "comment": "Date de dernière mise à jour du compte"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "columns": ["id"],
          "type": "PRIMARY KEY"
        },
        {
          "name": "users_email_unique",
          "columns": ["email"],
          "type": "UNIQUE"
        }
      ],
      "foreignKeys": [],
      "statistics": {
        "rowCount": 12458,
        "avgRowLength": 248,
        "dataSize": "3.1 MB",
        "indexSize": "1.2 MB"
      }
    },
    {
      "name": "profiles",
      "comments": "Informations de profil détaillées des utilisateurs",
      "columns": [
        {
          "name": "id",
          "type": "BIGINT(20) UNSIGNED",
          "nullable": false,
          "defaultValue": null,
          "autoIncrement": true,
          "comment": "Identifiant unique du profil"
        },
        {
          "name": "user_id",
          "type": "BIGINT(20) UNSIGNED",
          "nullable": false,
          "defaultValue": null,
          "comment": "Référence à l'ID de l'utilisateur propriétaire du profil"
        },
        {
          "name": "full_name",
          "type": "VARCHAR(255)",
          "nullable": true,
          "defaultValue": null,
          "comment": "Nom complet de l'utilisateur"
        },
        {
          "name": "address",
          "type": "VARCHAR(255)",
          "nullable": true,
          "defaultValue": null,
          "comment": "Adresse postale de l'utilisateur"
        },
        {
          "name": "phone",
          "type": "VARCHAR(20)",
          "nullable": true,
          "defaultValue": null,
          "comment": "Numéro de téléphone de l'utilisateur"
        },
        {
          "name": "avatar_url",
          "type": "VARCHAR(255)",
          "nullable": true,
          "defaultValue": null,
          "comment": "URL de l'image de profil de l'utilisateur"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "defaultValue": "CURRENT_TIMESTAMP",
          "comment": "Date de création du profil"
        },
        {
          "name": "updated_at",
          "type": "TIMESTAMP",
          "nullable": true,
          "defaultValue": null,
          "onUpdate": "CURRENT_TIMESTAMP",
          "comment": "Date de dernière mise à jour du profil"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "columns": ["id"],
          "type": "PRIMARY KEY"
        },
        {
          "name": "profiles_user_id_unique",
          "columns": ["user_id"],
          "type": "UNIQUE"
        }
      ],
      "foreignKeys": [
        {
          "name": "profiles_user_id_foreign",
          "columns": ["user_id"],
          "referencedTable": "users",
          "referencedColumns": ["id"],
          "onDelete": "CASCADE",
          "onUpdate": "CASCADE"
        }
      ],
      "statistics": {
        "rowCount": 8932,
        "avgRowLength": 320,
        "dataSize": "2.8 MB",
        "indexSize": "0.8 MB"
      }
    },
    {
      "name": "sessions",
      "comments": "Sessions utilisateur pour l'authentification persistante",
      "columns": [
        {
          "name": "id",
          "type": "VARCHAR(40)",
          "nullable": false,
          "defaultValue": null,
          "comment": "Identifiant unique de la session"
        },
        {
          "name": "user_id",
          "type": "BIGINT(20) UNSIGNED",
          "nullable": true,
          "defaultValue": null,
          "comment": "Référence à l'ID de l'utilisateur associé à la session"
        },
        {
          "name": "token",
          "type": "VARCHAR(255)",
          "nullable": false,
          "defaultValue": null,
          "comment": "Token d'authentification unique pour la session"
        },
        {
          "name": "ip_address",
          "type": "VARCHAR(45)",
          "nullable": true,
          "defaultValue": null,
          "comment": "Adresse IP de l'utilisateur lors de la création de la session"
        },
        {
          "name": "user_agent",
          "type": "TEXT",
          "nullable": true,
          "defaultValue": null,
          "comment": "Agent utilisateur du navigateur ou de l'application"
        },
        {
          "name": "payload",
          "type": "TEXT",
          "nullable": false,
          "defaultValue": null,
          "comment": "Données de session sérialisées en JSON"
        },
        {
          "name": "last_activity",
          "type": "INT",
          "nullable": false,
          "defaultValue": null,
          "comment": "Timestamp UNIX de la dernière activité de la session"
        },
        {
          "name": "created_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "defaultValue": "CURRENT_TIMESTAMP",
          "comment": "Date de création de la session"
        },
        {
          "name": "expires_at",
          "type": "TIMESTAMP",
          "nullable": false,
          "defaultValue": null,
          "comment": "Date d'expiration de la session"
        }
      ],
      "indexes": [
        {
          "name": "PRIMARY",
          "columns": ["id"],
          "type": "PRIMARY KEY"
        },
        {
          "name": "sessions_token_unique",
          "columns": ["token"],
          "type": "UNIQUE"
        },
        {
          "name": "sessions_user_id_index",
          "columns": ["user_id"],
          "type": "INDEX"
        }
      ],
      "foreignKeys": [
        {
          "name": "sessions_user_id_foreign",
          "columns": ["user_id"],
          "referencedTable": "users",
          "referencedColumns": ["id"],
          "onDelete": "CASCADE",
          "onUpdate": "CASCADE"
        }
      ],
      "statistics": {
        "rowCount": 67349,
        "avgRowLength": 568,
        "dataSize": "38.2 MB",
        "indexSize": "14.6 MB"
      }
    }
  ],
  "relationships": [
    {
      "name": "users_profiles",
      "type": "ONE_TO_ONE",
      "sourceTable": "users",
      "targetTable": "profiles",
      "sourceColumn": "id",
      "targetColumn": "user_id",
      "isMandatory": false,
      "comment": "Chaque utilisateur peut avoir un profil associé"
    },
    {
      "name": "users_sessions",
      "type": "ONE_TO_MANY",
      "sourceTable": "users",
      "targetTable": "sessions",
      "sourceColumn": "id",
      "targetColumn": "user_id",
      "isMandatory": false,
      "comment": "Chaque utilisateur peut avoir plusieurs sessions actives"
    }
  ],
  "analyses": {
    "dataTypes": {
      "inconsistencies": [
        {
          "description": "Le champ 'payload' dans sessions est stocké en TEXT alors qu'il contient du JSON",
          "recommendation": "Convertir en JSONB dans PostgreSQL"
        },
        {
          "description": "Le champ 'last_activity' dans sessions est stocké en INT (timestamp UNIX) au lieu d'un type date",
          "recommendation": "Convertir en TIMESTAMPTZ dans PostgreSQL"
        },
        {
          "description": "Les champs booléens comme 'is_admin' utilisent TINYINT(1) au lieu d'un type booléen",
          "recommendation": "Convertir en BOOLEAN natif dans PostgreSQL"
        }
      ],
      "optimizationPotential": [
        {
          "description": "Tous les champs 'created_at' et 'updated_at' utilisent TIMESTAMP sans fuseau horaire",
          "recommendation": "Convertir en TIMESTAMPTZ pour une meilleure gestion des fuseaux horaires"
        },
        {
          "description": "Le champ 'status' utilise ENUM MySQL qui n'est pas supporté directement en PostgreSQL",
          "recommendation": "Convertir en type ENUM Prisma + CHECK constraint PostgreSQL"
        }
      ]
    },
    "indexes": {
      "missing": [
        {
          "table": "users",
          "columns": ["status"],
          "reason": "Filtres fréquents sur le statut utilisateur"
        },
        {
          "table": "profiles",
          "columns": ["full_name", "address"],
          "reason": "Recherches fréquentes sur ces champs"
        },
        {
          "table": "sessions",
          "columns": ["expires_at"],
          "reason": "Requêtes de nettoyage basées sur date d'expiration"
        }
      ],
      "redundant": []
    },
    "constraints": {
      "missing": [
        {
          "description": "Pas de contrainte CHECK sur 'email' pour valider le format",
          "recommendation": "Ajouter une validation regex dans PostgreSQL"
        },
        {
          "description": "Pas de contrainte CHECK sur 'phone' pour valider le format",
          "recommendation": "Ajouter une validation regex dans PostgreSQL"
        }
      ]
    },
    "namingConventions": {
      "comment": "Le schéma utilise des snake_case pour les noms de colonnes",
      "recommendation": "Utiliser @map dans Prisma pour supporter snake_case en base de données et camelCase en code"
    }
  },
  "stats": {
    "tableCount": 3,
    "columnCount": 24,
    "indexCount": 6,
    "foreignKeyCount": 2,
    "totalDataSizeMB": 44.1,
    "totalIndexSizeMB": 16.6,
    "largestTable": {
      "name": "sessions",
      "sizeInMB": 38.2
    },
    "mostReferencedTable": {
      "name": "users",
      "referencesCount": 2
    }
  },
  "database": "your_application_db",
  "tables": {
    "users": {
      "columns": {
        "id": {
          "type": "bigint(20)",
          "nullable": false,
          "primary": true,
          "auto_increment": true
        },
        "email": {
          "type": "varchar(255)",
          "nullable": false,
          "unique": true
        },
        "password": {
          "type": "varchar(255)",
          "nullable": false
        },
        "status": {
          "type": "enum('active','inactive','suspended','deleted')",
          "nullable": false,
          "default": "active"
        },
        "is_admin": {
          "type": "tinyint(1)",
          "nullable": false,
          "default": "0"
        },
        "created_at": {
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "updated_at": {
          "type": "timestamp",
          "nullable": true
        }
      },
      "indexes": {
        "PRIMARY": {
          "columns": ["id"],
          "type": "PRIMARY"
        },
        "users_email_unique": {
          "columns": ["email"],
          "type": "UNIQUE"
        }
      },
      "foreign_keys": {}
    },
    "profiles": {
      "columns": {
        "id": {
          "type": "bigint(20)",
          "nullable": false,
          "primary": true,
          "auto_increment": true
        },
        "user_id": {
          "type": "bigint(20)",
          "nullable": false
        },
        "full_name": {
          "type": "varchar(100)",
          "nullable": true
        },
        "address": {
          "type": "text",
          "nullable": true
        },
        "phone": {
          "type": "varchar(20)",
          "nullable": true
        },
        "avatar_url": {
          "type": "varchar(255)",
          "nullable": true
        },
        "created_at": {
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "updated_at": {
          "type": "timestamp",
          "nullable": true
        }
      },
      "indexes": {
        "PRIMARY": {
          "columns": ["id"],
          "type": "PRIMARY"
        },
        "profiles_user_id_unique": {
          "columns": ["user_id"],
          "type": "UNIQUE"
        }
      },
      "foreign_keys": {
        "profiles_user_id_foreign": {
          "columns": ["user_id"],
          "referenced_table": "users",
          "referenced_columns": ["id"],
          "on_update": "CASCADE",
          "on_delete": "CASCADE"
        }
      }
    },
    "sessions": {
      "columns": {
        "id": {
          "type": "varchar(40)",
          "nullable": false,
          "primary": true
        },
        "user_id": {
          "type": "bigint(20)",
          "nullable": true
        },
        "token": {
          "type": "varchar(255)",
          "nullable": false
        },
        "ip_address": {
          "type": "varchar(45)",
          "nullable": true
        },
        "user_agent": {
          "type": "text",
          "nullable": true
        },
        "payload": {
          "type": "text",
          "nullable": false
        },
        "last_activity": {
          "type": "timestamp",
          "nullable": false
        },
        "created_at": {
          "type": "timestamp",
          "nullable": false,
          "default": "CURRENT_TIMESTAMP"
        },
        "expires_at": {
          "type": "timestamp",
          "nullable": false
        }
      },
      "indexes": {
        "PRIMARY": {
          "columns": ["id"],
          "type": "PRIMARY"
        },
        "sessions_token_unique": {
          "columns": ["token"],
          "type": "UNIQUE"
        }
      },
      "foreign_keys": {
        "sessions_user_id_foreign": {
          "columns": ["user_id"],
          "referenced_table": "users",
          "referenced_columns": ["id"],
          "on_update": "CASCADE",
          "on_delete": "CASCADE"
        }
      }
    }
  },
  "relationships": [
    {
      "name": "user_has_profile",
      "type": "one-to-one",
      "from_table": "users",
      "from_column": "id",
      "to_table": "profiles",
      "to_column": "user_id"
    },
    {
      "name": "user_has_many_sessions",
      "type": "one-to-many",
      "from_table": "users",
      "from_column": "id",
      "to_table": "sessions",
      "to_column": "user_id"
    }
  ]
}