version: "3"

tasks:
  check:
    desc: Lance toutes les vÃ©rifications CI
    cmds:
      - task: lint
      - task: test
      - task: build
      - echo "âœ… VÃ©rifications CI terminÃ©es"

  lint:
    desc: Lance le linting du code
    cmds:
      - echo "ğŸ” Linting du code..."
      - pnpm lint
      - echo "âœ… Linting terminÃ©"

  test:
    desc: Lance les tests unitaires et d'intÃ©gration
    cmds:
      - echo "ğŸ§ª ExÃ©cution des tests..."
      - pnpm test
      - echo "âœ… Tests terminÃ©s"

  build:
    desc: VÃ©rifie que l'application peut Ãªtre construite
    cmds:
      - echo "ğŸ”§ VÃ©rification de la construction..."
      - pnpm build --dry-run
      - echo "âœ… Construction vÃ©rifiÃ©e"
    
  verify-temporal:
    desc: VÃ©rifie les workflows Temporal
    cmds:
      - node src/temporal/testing/workflow-tests.js

  deploy:staging:
    desc: DÃ©ploie l'application sur l'environnement de staging
    cmds:
      - echo "ğŸš€ DÃ©ploiement vers staging..."
      - pnpm build
      - node scripts/deploy.js --env=staging
      - echo "âœ… DÃ©ploiement terminÃ©"

  deploy:production:
    desc: DÃ©ploie l'application en production
    cmds:
      - echo "âš ï¸ DÃ©ploiement vers la production..."
      - pnpm build
      - node scripts/deploy.js --env=production
      - echo "âœ… DÃ©ploiement terminÃ©"

  quality-check:
    desc: Lance une vÃ©rification approfondie de la qualitÃ© du code
    cmds:
      - echo "ğŸ” Analyse de la qualitÃ© du code..."
      - pnpm test:coverage
      - node scripts/code-quality-check.js
      - echo "âœ… VÃ©rification terminÃ©e"