<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cahier des Charges ‚Äì Vue compl√®te</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, sans-serif;
      margin: 0 auto;
      padding: 2rem;
      max-width: 1000px;
      background: #fdfdfd;
      color: #1a1a1a;
      line-height: 1.6;
    }
    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 2rem;
    }
    h2 {
      border-bottom: 2px solid #ccc;
      padding-bottom: 0.3rem;
      margin-top: 2rem;
      color: #2c3e50;
    }
    pre {
      background: #f4f4f4;
      padding: 1rem;
      border-left: 4px solid #3498db;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .file-section {
      margin-bottom: 3rem;
      background: #fff;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.05);
    }
    .file-section h2 {
      font-size: 1.5rem;
      margin-top: 0;
    }
    .filename {
      font-size: 0.9rem;
      color: #999;
      margin-top: -1rem;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
    ul {
      padding-left: 1.5rem;
    }
    nav.toc {
      margin-bottom: 3rem;
      padding: 1.5rem;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.08);
    }
    nav.toc h2 {
      margin-top: 0;
      border-bottom: 1px solid #ddd;
      padding-bottom: 0.5rem;
    }
    nav.toc ul {
      list-style: none;
      padding: 0;
    }
    nav.toc li {
      margin: 0.5rem 0;
    }
    nav.toc a {
      text-decoration: none;
      color: #3498db;
    }
    nav.toc a:hover {
      text-decoration: underline;
    }
    footer {
      text-align: center;
      margin-top: 2rem;
      color: #777;
      font-size: 0.9rem;
    }
    /* Pour la responsivit√© */
    @media (max-width: 768px) {
      body {
        padding: 1rem;
      }
      .file-section {
        padding: 1rem;
      }
    }
  </style>
</head>
<body>
  <h1>üìò Cahier des Charges ‚Äì Vue unifi√©e</h1>

  <nav class="toc">
    <h2>üìë Sommaire</h2>
    <ul>
      <li><a href="#00-sommaire">Cahier des Charges ‚Äì Sommaire</a></li><li><a href="#01-introduction">Introduction</a></li><li><a href="#10-checklist-pre-migration">‚úÖ Checklist d'avant lancement ‚Äì Migration IA s√©curis√©e</a></li><li><a href="#10b-verification-env-test">‚úÖ 2. V√©rification et validation de l'environnement de test</a></li><li><a href="#10c-finaliser-profil-monorepo">‚úÖ 3. Finaliser le profil du monorepo (profil de r√©f√©rence)</a></li><li><a href="#10d-backlog-par-modules">‚úÖ 4. Organiser le backlog de migration par modules fonctionnels</a></li><li><a href="#changelog">Historique des modifications</a></li>
    </ul>
  </nav>

  
    <div class="file-section" id="00-sommaire">
      <h2>Cahier des Charges ‚Äì Sommaire</h2>
      <div class="filename">00-sommaire.md</div>
      <pre># Cahier des Charges ‚Äì Sommaire

- [[01-introduction.md]] ‚Äì Introduction
- [[10-checklist-pre-migration.md]] ‚Äì ‚úÖ Checklist d'avant lancement ‚Äì Migration IA s√©curis√©e
- [[10b-verification-env-test.md]] ‚Äì ‚úÖ 2. V√©rification et validation de l'environnement de test
- [[10c-finaliser-profil-monorepo.md]] ‚Äì ‚úÖ 3. Finaliser le profil du monorepo (profil de r√©f√©rence)
- [[10d-backlog-par-modules.md]] ‚Äì ‚úÖ 4. Organiser le backlog de migration par modules fonctionnels
</pre>
    </div>
    
    <div class="file-section" id="01-introduction">
      <h2>Introduction</h2>
      <div class="filename">01-introduction.md</div>
      <pre># Introduction

Ce document constitue le cahier des charges du projet.
</pre>
    </div>
    
    <div class="file-section" id="10-checklist-pre-migration">
      <h2>‚úÖ Checklist d'avant lancement ‚Äì Migration IA s√©curis√©e</h2>
      <div class="filename">10-checklist-pre-migration.md</div>
      <pre># ‚úÖ Checklist d'avant lancement ‚Äì Migration IA s√©curis√©e

üéØ Objectif : Avant d'appuyer sur "GO", garantir la pr√©cision, tra√ßabilit√©, auditabilit√© et un retour arri√®re possible √† tout moment.

---

## üîí 1. Geler une copie du code legacy PHP et SQL (immuable)

| Action                          | Objectif |
|---------------------------------|----------|
| Cr√©er un tag Git `legacy-php-vFinal`       | Avoir un point de retour s√ªr |
| Sauvegarder `mysql.sql` horodat√© (`YYYYMMDD`) | R√©f√©rence absolue pour `schema_migration_diff.json` |
| Archiver le fichier `.htaccess` original   | Reproduire les routes + r√®gles SEO √† l'identique |
| Archiver tous les scripts `core/*.php`     | Permet la comparaison avec les blocs migr√©s |
| G√©n√©rer le hash SHA256 du dossier legacy   | V√©rification d'int√©grit√© (via `audit.md`) |

---

## üì¶ 2. Geler la structure cible (NestJS + Remix + Prisma)

| Action | Objectif |
|--------|----------|
| Snapshot de la branche `main` NestJS/Remix | Base de comparaison pour `schema_migration_diff.json` |
| Export du `schema.prisma` initial | Base pour l'√©volution vers PostgreSQL |
| G√©n√©ration d'un `structure_index.json` | Permet le mapping entre legacy et modules modernes |

---

## üß† 3. Pr√©parer le socle IA d'analyse et de migration

| Action | Objectif |
|--------|----------|
| Lancer `start_analysis.sh` (PhpMetrics, MCP, etc.) | Audit du code legacy |
| G√©n√©rer les fichiers `.audit.md`, `.impact_graph.json` | Identifier les modules critiques |
| Valider les d√©pendances IA locales (DeepSeek, n8n) | V√©rifier que tous les agents sont op√©rationnels |
| Lancer une PR de pr√©paration de migration | Cr√©e un point d'entr√©e dans le GitOps |
| Archiver toutes les entr√©es critiques dans `backlog.md` | Structurer la feuille de route IA |

---

## üìÅ 4. Checklist bonus s√©curit√©

- [ ] ‚úÖ Tous les fichiers legacy sont archiv√©s dans `/archives/legacy/`
- [ ] ‚úÖ Une PR a √©t√© cr√©√©e pour le verrouillage initial
- [ ] ‚úÖ Les cl√©s d'acc√®s (BDD, Supabase, IA) sont hors du d√©p√¥t Git
- [ ] ‚úÖ Un fichier `changelog.md` a √©t√© initialis√©
- [ ] ‚úÖ Le dashboard Remix `/admin/dashboard` peut afficher le statut

üí° Cette checklist peut √™tre int√©gr√©e dans le pipeline `n8n` via un agent `pre-migration-verifier.ts`.
Elle peut √©galement d√©clencher une v√©rification automatique √† chaque modification du legacy.
</pre>
    </div>
    
    <div class="file-section" id="10b-verification-env-test">
      <h2>‚úÖ 2. V√©rification et validation de l'environnement de test</h2>
      <div class="filename">10b-verification-env-test.md</div>
      <pre># ‚úÖ 2. V√©rification et validation de l'environnement de test

üéØ Objectif : S'assurer que tous les outils critiques de migration sont op√©rationnels, interconnect√©s, et correctement configur√©s avant le lancement du pipeline.

---

## üîç V√©rification de l'environnement

| Outil                      | Objectif |
|----------------------------|----------|
| **n8n**                    | Orchestrateur d'agents IA. Doit √™tre d√©ploy√© avec acc√®s au filesystem pour lecture/√©criture. |
| **Docker / Code Server**  | N√©cessaires pour l'ex√©cution des agents, t√¢ches automatis√©es, scripts de conversion et analyse. |
| **MCP**                    | Doit √™tre configur√© avec un token GitHub valide pour cr√©er/valider des PR automatis√©es. |
| **Supabase** ou **CSV centralis√©** | Base de donn√©es ou fichier de suivi des fichiers PHP migr√©s (statut, date, responsable, delta). |
| **Coolify** ou **Netlify Preview** | Permet la pr√©visualisation automatique des PR (version migr√©e vs legacy) via une URL unique. |

---

## ‚úÖ Checklist de validation

- [ ] n8n est op√©rationnel, accessible via navigateur
- [ ] Les agents de test s'ex√©cutent correctement via Code Server/Docker
- [ ] MCP r√©pond √† une requ√™te de test avec le token GitHub
- [ ] Supabase contient une table `migration_status` ou CSV accessible
- [ ] Chaque PR de migration g√©n√®re un lien de preview Netlify ou Coolify

üí° Cette v√©rification peut √™tre automatis√©e dans `n8n` via un agent `env-tester.ts`
et d√©clench√©e avant chaque ex√©cution majeure du pipeline de migration.
</pre>
    </div>
    
    <div class="file-section" id="10c-finaliser-profil-monorepo">
      <h2>‚úÖ 3. Finaliser le profil du monorepo (profil de r√©f√©rence)</h2>
      <div class="filename">10c-finaliser-profil-monorepo.md</div>
      <pre># ‚úÖ 3. Finaliser le profil du monorepo (profil de r√©f√©rence)

üéØ Objectif : Cr√©er un profil d'analyse du monorepo **avant migration**, utilis√© comme r√©f√©rence dans tous les agents IA (g√©n√©rateurs, validateurs, synchronisateurs, etc.)

---

## üóÇÔ∏è Fichiers de profil √† g√©n√©rer et valider

| Fichier                         | Description |
|--------------------------------|-------------|
| `code_style_profile.json`      | Repr√©sente les conventions de code en vigueur : indentation, noms de classes, importations, typage |
| `monorepo_dependencies.json`   | Liste des packages utilis√©s dans le projet (Remix, NestJS, Prisma, DTOs, tailwind, etc.) |
| `nestjs_module_patterns.json`  | Exemple type d'un module NestJS avec structure `controller/service/dto/module` |
| `remix_component_patterns.json`| Exemples des composants Remix utilis√©s : `loader.ts`, `meta.ts`, `layout.tsx`, `form.tsx` |
| `tailwind_tokens.json`         | Liste des classes Tailwind custom utilis√©es (couleurs, spacings, breakpoints) |

---

## üìå Utilisation

- Tous ces fichiers sont utilis√©s par les agents IA (dev-generator, audit-checker, route-mapper) pour :
  - Garantir une migration **coh√©rente avec l'existant**
  - D√©tecter automatiquement les anomalies ou divergences
  - G√©n√©rer du code conforme aux pratiques internes

---

## ‚úÖ Checklist

- [ ] Les fichiers ci-dessus sont pr√©sents dans `/profil/`
- [ ] Tous les fichiers ont √©t√© valid√©s √† partir du code existant
- [ ] Chaque agent IA les r√©f√©rence au chargement
- [ ] Le changelog contient la date de cr√©ation du profil de r√©f√©rence
- [ ] Une PR `profil-initialisation` est cr√©√©e avec les fichiers de base

üí° Ces fichiers peuvent √™tre g√©n√©r√©s automatiquement via l'agent `monorepo-analyzer.ts`
et int√©gr√©s dans un pipeline `n8n` d√©clench√© √† chaque mise √† jour majeure.
</pre>
    </div>
    
    <div class="file-section" id="10d-backlog-par-modules">
      <h2>‚úÖ 4. Organiser le backlog de migration par modules fonctionnels</h2>
      <div class="filename">10d-backlog-par-modules.md</div>
      <pre># ‚úÖ 4. Organiser le backlog de migration par modules fonctionnels

üéØ Objectif : Structurer le backlog de migration selon des **domaines fonctionnels clairs**, facilitant la gestion des d√©pendances, le versioning progressif et la coordination multi-√©quipe.

---

## üß© Exemples de groupes de modules fonctionnels

| Groupe                        | Modules inclus                              | Avantages |
|------------------------------|---------------------------------------------|-----------|
| **Authentification**         | Login, inscription, mot de passe oubli√©     | D√©coupl√©, peu d√©pendant |
| **Compte utilisateur**       | Donn√©es personnelles, historique commandes  | Migration autonome |
| **Panier / Commande**        | Shopping Cart, √©tapes de commande, paiement | Bloc logique complet |
| **Produits**                 | Fiche produit, variantes, stocks            | Optimis√© pour les tests UI/API |
| **Recherche & navigation**   | Moteur, filtres, redirections SEO           | Impact SEO imm√©diat |
| **SEO / R√©√©criture**         | Meta, URLs legacy, page 404/410/412         | Pr√©serve l'indexation |
| **Admin & backoffice**       | Gestion catalogue, comptes, logs            | Utilisateurs internes |

---

## üì¶ Avantages de cette approche

- ‚úÖ Migration **modulaire** et **rollbackable**
- ‚úÖ Moins de conflits entre branches ou fichiers
- ‚úÖ Permet une PR par bloc fonctionnel
- ‚úÖ Adapt√© √† une gestion Kanban dans `backlog.md`
- ‚úÖ Revue cibl√©e, d√©ploiement par tranche

---

## ‚úÖ √Ä faire

- [ ] Lier chaque ligne de `13-backlog.md` √† un groupe fonctionnel
- [ ] Ajouter un tag dans le tableau : `fonction=auth / produits / seo`
- [ ] Cr√©er une **vue par groupe fonctionnel** dans Notion ou GitHub Projects
- [ ] Utiliser un agent IA `backlog-classifier.ts` pour classer automatiquement les fichiers

üí° Cette strat√©gie est id√©ale pour synchroniser le backlog avec les fichiers PHP legacy et les blocs Remix/NestJS modernes.
</pre>
    </div>
    
    <div class="file-section" id="changelog">
      <h2>Historique des modifications</h2>
      <div class="filename">changelog.md</div>
      <pre># Historique des modifications

## 2025-04-06 17:21 ‚Äì Initialisation
- Cr√©ation de la structure du cahier des charges

## 2025-04-06 17:21 ‚Äì Mise √† jour automatique
- Auteur : auto pieces equipement
- Fichiers modifi√©s :\n

## 2025-04-06 17:22 ‚Äì Mise √† jour automatique
- Auteur : auto pieces equipement
- Fichiers modifi√©s :\n

## 2025-04-06 17:24 ‚Äì Mise √† jour automatique
- Auteur : auto pieces equipement
- Fichiers modifi√©s :\n

## 2025-04-06 17:25 ‚Äì Mise √† jour automatique
- Auteur : auto pieces equipement
- Fichiers modifi√©s :\n
</pre>
    </div>
    

  <footer>
    Document g√©n√©r√© le Sun Apr  6 17:34:06 UTC 2025
  </footer>
</body>
</html>
