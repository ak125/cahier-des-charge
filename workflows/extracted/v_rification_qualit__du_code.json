{
  "id": "dev-checker-workflow",
  "name": "V√©rification Qualit√© du Code",
  "active": true,
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 0 * * *"
            }
          ]
        }
      },
      "name": "D√©clencheur Quotidien",
      "type": "n8n-nodes-base.cron",
      "position": [100, 200],
      "typeVersion": 1
    },
    {
      "parameters": {
        "triggerTimes": {}
      },
      "name": "D√©clencheur Manuel",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [100, 340],
      "typeVersion": 1
    },
    {
      "parameters": {
        "authentication": "genericCredentialType",
        "httpMethod": "POST",
        "path": "dev-check-trigger",
        "options": {}
      },
      "name": "Webhook GitHub PR",
      "type": "n8n-nodes-base.webhook",
      "position": [100, 480],
      "webhookId": "dev-check-webhook",
      "typeVersion": 1
    },
    {
      "parameters": {
        "mode": "mergeByPosition"
      },
      "name": "Merge D√©clencheurs",
      "type": "n8n-nodes-base.merge",
      "position": [300, 340],
      "typeVersion": 2
    },
    {
      "parameters": {
        "command": "cd /workspaces/cahier-des-charge && npx tsx apps/mcp-server/src/handleAgentRequest.ts dev-checker",
        "workingDirectory": "/workspaces/cahier-des-charge",
        "executeTimeout": 300
      },
      "name": "Ex√©cuter Dev Checker",
      "type": "n8n-nodes-base.executeCommand",
      "position": [500, 340],
      "typeVersion": 1
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.stdout.includes('‚ùå Erreur') }}",
              "value2": true
            }
          ]
        }
      },
      "name": "Erreurs D√©tect√©es?",
      "type": "n8n-nodes-base.if",
      "position": [700, 340],
      "typeVersion": 1
    },
    {
      "parameters": {
        "command": "cd /workspaces/cahier-des-charge && npx tsx apps/mcp-server/src/handleAgentRequest.ts dev-checker --fix",
        "workingDirectory": "/workspaces/cahier-des-charge",
        "executeTimeout": 300
      },
      "name": "Tentative Auto-Correction",
      "type": "n8n-nodes-base.executeCommand",
      "position": [900, 240],
      "typeVersion": 1
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.stdout.includes('corrections automatiques appliqu√©es') }}",
              "value2": true
            }
          ]
        }
      },
      "name": "Corrections Appliqu√©es?",
      "type": "n8n-nodes-base.if",
      "position": [1100, 240],
      "typeVersion": 1
    },
    {
      "parameters": {
        "chatId": "{{ $env.NOTIFICATION_CHAT_ID }}",
        "text": "‚ö†Ô∏è *Probl√®mes d√©tect√©s dans le code*\n\nL'agent dev-checker a d√©tect√© des probl√®mes dans le code qui n√©cessitent une attention manuelle.\n\n[Voir le rapport d√©taill√©]({{ $env.DASHBOARD_URL }}/reports/dev_check_report.md)",
        "additionalFields": {
          "parseMode": "Markdown",
          "disableNotification": false
        }
      },
      "name": "Notifier Probl√®mes",
      "type": "n8n-nodes-base.telegram",
      "position": [1300, 340],
      "typeVersion": 1
    },
    {
      "parameters": {
        "chatId": "{{ $env.NOTIFICATION_CHAT_ID }}",
        "text": "üõ†Ô∏è *Corrections automatiques appliqu√©es*\n\nL'agent dev-checker a identifi√© et corrig√© automatiquement certains probl√®mes dans le code.\n\n[Voir le rapport d√©taill√©]({{ $env.DASHBOARD_URL }}/reports/dev_check_report.md)",
        "additionalFields": {
          "parseMode": "Markdown",
          "disableNotification": false
        }
      },
      "name": "Notifier Corrections",
      "type": "n8n-nodes-base.telegram",
      "position": [1300, 120],
      "typeVersion": 1
    },
    {
      "parameters": {
        "command": "cd /workspaces/cahier-des-charge && git add . && git commit -m \"ü§ñ Corrections automatiques par dev-checker\" && git push",
        "workingDirectory": "/workspaces/cahier-des-charge",
        "executeTimeout": 60
      },
      "name": "Commit et Push Corrections",
      "type": "n8n-nodes-base.executeCommand",
      "position": [1500, 120],
      "typeVersion": 1
    },
    {
      "parameters": {
        "chatId": "{{ $env.NOTIFICATION_CHAT_ID }}",
        "text": "‚úÖ *V√©rification du code compl√©t√©e*\n\nL'agent dev-checker n'a d√©tect√© aucun probl√®me.\n\n[Voir le rapport d√©taill√©]({{ $env.DASHBOARD_URL }}/reports/dev_check_report.md)",
        "additionalFields": {
          "parseMode": "Markdown",
          "disableNotification": true
        }
      },
      "name": "Notifier Succ√®s",
      "type": "n8n-nodes-base.telegram",
      "position": [900, 440],
      "typeVersion": 1
    }
  ],
  "connections": {
    "D√©clencheur Quotidien": {
      "main": [
        [
          {
            "node": "Merge D√©clencheurs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "D√©clencheur Manuel": {
      "main": [
        [
          {
            "node": "Merge D√©clencheurs",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Webhook GitHub PR": {
      "main": [
        [
          {
            "node": "Merge D√©clencheurs",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Merge D√©clencheurs": {
      "main": [
        [
          {
            "node": "Ex√©cuter Dev Checker",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ex√©cuter Dev Checker": {
      "main": [
        [
          {
            "node": "Erreurs D√©tect√©es?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Erreurs D√©tect√©es?": {
      "main": [
        [
          {
            "node": "Tentative Auto-Correction",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Notifier Succ√®s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Tentative Auto-Correction": {
      "main": [
        [
          {
            "node": "Corrections Appliqu√©es?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Corrections Appliqu√©es?": {
      "main": [
        [
          {
            "node": "Notifier Corrections",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Notifier Probl√®mes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notifier Corrections": {
      "main": [
        [
          {
            "node": "Commit et Push Corrections",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  }
}
